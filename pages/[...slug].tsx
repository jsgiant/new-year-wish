import React, { useEffect } from "react";
import Head from "next/head";
import { useRouter } from "next/router";
import ConfettiGenerator from "confetti-js";
import { MdCreate } from "react-icons/md";

import useColor from "../hooks/useColor";
import { confettiConfig } from "../utils/ConfettiUtils";
import Footer from "../components/Footer";
import { getGreetingMessage } from "../utils/WishUtils";

import {
	ConfettiHolder,
	CreateNewButton,
	HomeWrapper,
	Icon,
	Name,
	WishMessage,
	WishText,
} from "./styledComponents";

const Wish = () => {
	const router = useRouter();
	const { slug } = router.query;
	const { currentColor } = useColor();
	const name = slug ? slug[0]?.toString() : "";

	useEffect(() => {
		const confetti = new ConfettiGenerator(confettiConfig);
		confetti.render();
		return () => confetti.clear();
	}, []);

	const goToHomePage = () => router.push("/");

	return (
		<>
			<Head>
				<title>Happy New Year {name} - By Anil</title>
				<meta name='description' content='Generated by create next app' />
				<link rel='icon' href='/favicon.ico' />
			</Head>
			<HomeWrapper theme={currentColor}>
				<ConfettiHolder id='confetti-holder'></ConfettiHolder>
				<WishText>
					Happy New Year <Name>{name}!!</Name>
				</WishText>
				<WishMessage>{getGreetingMessage()} </WishMessage>
				<CreateNewButton onClick={goToHomePage}>
					<Icon>
						<MdCreate />
					</Icon>{" "}
					Create New Wish
				</CreateNewButton>
				<Footer />
			</HomeWrapper>
		</>
	);
};

export default Wish;
